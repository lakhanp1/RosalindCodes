#!usr/bin/perl -w
use strict;
use warnings;
#use List::MoreUtils qw(uniq);

=head
Peptide Encoding Problem


There are three different ways to divide a DNA string into codons for translation, one starting at each of the first three starting positions of the string. These different ways of dividing a DNA string into codons are called reading frames. Since DNA is double-stranded, a genome has six reading frames (three on each strand), as shown in Figure 1.

We say that a DNA string Pattern encodes an amino acid string Peptide if the RNA string transcribed from either Pattern or its reverse complement Pattern translates into Peptide.
Peptide Encoding Problem

Find substrings of a genome encoding a given amino acid sequence.

Given: A DNA string Text and an amino acid string Peptide.

Return: All substrings of Text encoding Peptide (if any such substrings exist).
Sample Dataset

ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA
MA

Sample Output

ATGGCC
GGCCAT
ATGGCC

=cut


my $dna = "GGGAAATTGGGACTTTATAGTGTTCACTCTGATAGAGTCATATCACATCCTAACCACCTGTAAACTCACTAGCTGACAGGGAGAATTTTCCTGTTTGATCCCACGTCGGGGGACAGGGGAGTATGTGGTCTTGTCATCTTTGGCCAAGTTTAGCTCACTAGGCGACGCTAAAAGAGTATTGCATACGAATCGCTGTTGATTGTCATCCTCCTCTGGTCTGGACGCGCTGAGCTTTTTACGAGTTAATACAGGTGTACCCTGAATACTGTTTTCCTAAGAAGTACCGCGCGATGCTCCGAAGGCGTGTGCGGCGCGAACTGGCAACAAACATATAACTTTGAACCTGCCCAGCTCAATTTATCCCTCCTAACTCTATATACCCCGGGAAGGGGGTCCCGGGTAATTGTACTTTAACGGTCTGCACTTTTAAGGACGAGCTCACGGCCGCCTGTGCAAGCGCAACTAGTAGCAGCTATTGGTTTATTTTCATGTCACACTAGAAGCGAAGAGGATAACTCACACACCCGTCACCTCACAGGCGGTCGGCACAGATTGGATTAACCGTATTGGCCTTTGAAGAGAGGCCACACGAGCATCGGGTTGAGAGATTGTATGAGCTTTCGGCCAGAGATGCATGTTCCACCATAGGTTTACTTCTAGGGTACTGATGACTTAATCCGCGGTGAGGCTTGAGGATCAGTTTGATCCAGACAGTCAAGGGTTTTGGCCCTGGAGTTGTAAGTACTATAGTTAATCGAGTCGATGTTAATCGTAGGCTGGCTCTTTTACGAACGGTGTGAGGAGAAGCGGTCCAACCAATAAGTATGGTTCTCTCCGGCGACCCGGACGTCTACGGAAATTTACTTACTAGAAGTGGAAAGTCGTTGAGGGTTTCTGTCGTGACATAAACGTTACGACCCTATCCTTTCGCCGCAATCCGTCTCACTATATGTACAACTGGACTTGGCCAAGCGCGAACATATAAGGACCCGTACTGGAGGAAGGGCCAGATAGTGGGATGACCGTGGGATTGGCTAGGGGTCGTGCAAAACAACATATTTGCACCTGGCTGGTTGCACTACCGACACCCGTGTATGCAAGACGTAACCCCAGTGCGCGTAAAGGGTTCCCAAGTTAGGACCCTCAAGGTGGAATGCCATTTGTTCCCGGGGCGCTCCATGGTAGATAGCTATAAATCGGCCCTATAGACAGATGACATCCGTGAGGGCCGTCATAAATGCAGCGGAGTGTAATGTTTTATGAGACCTTGTCCTGGTCTCCTACGTCTCAACTAAATTCGAACTTGCGCCAGATTAAGGCTCAGGCCCGGCAATGCGGGAACTGCTTTTGGGCCGAGACCCACCCCTCCAGGCTTAGGGAACTAAGGAAAGAGAACCGGTCCTCCTGCATAGTATAAGTGCCGTTGATGTAAAATGTCAGTAGAGTTGGCCTACTCAAGGAATACCATCCTGGTCTTACGACCGCTTTTGTTAGTATGCTTATACAGATGGCTGCATATGTTAATTCTGCGTTCCCGATCATAGGCTTATACCCTCATCTACATATAAAGGACGTAAGTACGTGCACCGAACCCATTTCAAACTCTACTAGATACGTTCGAACACCTTTCTCCTATTTCGTACAGGATGATAGGCGCGGAACTAGGTCCGGAAAGATCCCGCATCAAGCACTACACACCACTGCATTCAACAAACAGCGTTTACGTATTTCGGGAAAATCGGACAAATACATCCGCACTTGAATCGTGTCCGTGGGCTGAAGACACCCATCGTGTAGCGGTGTATAGTGTTTTATGCCATGTCGAGGATTCCGGTAAGTTTTGTCGCTCAACGCTGACGCAAAGAATGAGACCACTCCCGCCTGGGGTACACTTTGAACAAGACTAGGCTAATGGAAACGCAGGTGTTCGGTCTCCAAGTTAAGGAAGCACGAGCTTTAGACTGTGTCCTCCGGGGCGAATTCGTCGGCGAGGAAGTGGGGTAGGGTGAGCTATCCTTCTCCAGGATGTGGTGACTGCGGTCAAGATGAATCTCGACCGACCTGTCTCGTGCAACAGACATCTCTCATCCACTGCCATCGGATTCAAATGGAAGGAATTAGCGTGGTGCACGCGCTTATGGTGGTGATATCAACGCCGTCCATTCTGTGGAGTACCCCATGTCAGCAGAAGAGGGCCAACGACGCTTGTCCTCCCCGAGCAATAAAACACTATACTCCACTTCATACGTAAACCTCCTTTACATGCCCTCTTGCGCGCTGGAAAGATGTCCTAACTATGGCCATCTTCACTGAGGGCTGGAGGAGGAGACATCTATTTATTAAGTATGTGTAAAAACAAGATGATGCAACGATGTAGTACTACCAGCAGGTGCGGGATGGTCATACACTTGATAGATTACACAGGGATACATTGCAAGTATAACAAGAGAACTTGCATTAAACATTACACACCTCTCCATCGAAAGGCAGCTTGTATATACAGCTGAGCTACGGACAATGAGGCTCACGTTCGCAATATGCCGACCTGCAGCTGGTGCCAACACGTACTACAGCGGCGAGTTGCTCAGTCCTCAGCCGTACGGGAGAAGTGGATGACAACGACATGACGTTTAAACACGGAAGTCATGGCCACGCCCCCTGCAACAAATCCGTGTCTCCATTGCCGTTGTATTGGTAAGAGGGCAGTCTGGAGGTATAGCGCCCGGTTATATCCCCAGAACCCTGGTGTACGAGAGTTACGCCCGAAAGTCGTTGTACTCTATCTGTTATTTTGTACCTCAGCGCATCGAAACGCGTCGGCCCGCCTAATTGCTGACCCCCACCGGGAGCTAAAGGCCATATTTTCAAGGTTTCAGAGATCGCATTAAACACTATACTCCGTTGCATATAGTGTGACATCCTGGGAAAATCGAGGTATATCTTTACACGAGCATCATTAAACATTACACCCCACTGCATTGGTAGTTGGTGGTCGGTATCAAGCACTATACGCCATTACACCGATTTGCTCAATAATCCCATAAGGGCAGCGGTCGTTATAAGTGACGTCCTTTAACAAGCTCTCTTGATCACCTCACGGGTCTGTCCTGTTCTTTCGCCGGCTGAAACGTTGGGGGGTTACCATGACGATCCACTCTCGGGATTTTTCCTTTTGCGCTGTATAAAGCTCCCATGGATATATAGCTTGCCCGACGTGGATCTCCGGCCGAGGCATGTGACCCAGTTTCACACACGGGGGAGTAATTGGGAGATAGTATTCATGCATAATTGTAGACTGGCCCTCCCGATGAAGTATACTACGACGCGTGCCCTATCCACAATCAGACGTCCGTTACAGACTCAACTTGTCAAAAGTACGTACTACAGGGTCCGTGCTCTAGGCTGTCCGGAAACGCCTGGTGCTTTAATAGATGGCGCTAGCTCACTCCAAGCACGATATTTACTTTGTAGTTCAAGTCGGGAACTCCAATCAGAGTCTCTAGTCCTCATCGAGTGACTATTGAAAACGACCACCATACGAACCTGGGTTCTTGTCCTGGTGCTACTTTACTAGAGAGCAGGCCAATATTTTATGTTTACTATGGGAGTTTCGTTCGTATAGTCGAAATCTGGGTAGGAGTGTAACTGCGCGTCTCAGCGGTTGGGCGCGTCAGGCTCGAATTATCCTCTTCTTAGAATTGGTCTATTTTCAATCAAGCACTATACGCCTCTACACGCCGGAGTCCTCAACGACGCCTCAACGATTAGCTATTCAAGCTCATTGTGGTATTCCGTCCCAGCAAGACGCTCGCCAATACCAGCCTACAAACCGAGGACGCACTCTGTGGGGGAACTTGGTTTTAGTCCGGGTGTCCGCCATATAACAGCCGCAGTAAATATCCATTAAGCACTATACTCCCCTGCATCCTTGAGGATGACCTTTGATTCGTAAATGTTCCTCCGAGGTGCGATATATCCTGGCCCGACGAACTATACTGCGTCAGTCCGTCAATAGCGAGTATTGACTAAGATACTGATAGGCCATGGGGGAACCATTGGGGATTTTGGCAGTGTTATGTCGTGGGACGATTCAAGTTGGTGGCGAGCGCCTGAGCTGTCGTCACCAGACTTCCTGGCGGTTCGCATTTACACTCACTCAGCGGCCGCGAATGCGTGCTGCTTCGATTATTGAAGGGTACTGCGACGAGCGACAACGAGAACGCTACTCTTAGCTTGTCTCCATACGCATCAAGCATTACACCCCTCTCCACTGTCACAAGAGTTAGGTGTACCTTTACGGATGTTTTGTTTAGGCTGTCTTCTTTGACCGACCTATGCTCTCTAACTAATAGCACGGGCTTGAAGGATATTACCATCCCGAAATTTCTTTGAAACGGTCATCAAACGTAAAGTCTTCCGTAAGGGCCTAGTGTGTAAAGGTGTGTAATGCTTGATAGTTAGTAATTCTGACGTGGGTTAGAAGAAAATCCTGGAGTTTACACAATACCAGTCACTCTCATTTATGTGAACAACGCCATCGATCGTAGTAGATAACGATCCAACGGGCAATAAATCCCCCGAACTGTTAGCACGTTCAGCATTGACCTTGGGGGAAAGCAATCGTTACCAACTTCTACACCGAGAATACGGTATGGTTTCGTCTGGACCTGGGGACAATTTTGCTGCACTGACCAACCAGCGTGATACGGCTGATGGGCGTCTAAGTAGTTTCAGAATATGACGCGTTTATATGGTTAATTCCCCTCCCATCGTGGGCGATTGCCTTCTCAGTGGGAAACAAAGTACGGAGGCCGCATTGAGAAGCCGTTCAGTACCACCTTCGTGGGCGTACTCTCGTTGGTTGCATAGTCGAAGGAACGGGGTCTGTCCAAACCGTCTGACGTAACAGTCAGGAATTATTCTCTTCGGGGGCAAAGCCCAACCAAGGACGGCCTAGCTGTGTGAGCTTCAGGCCGGGGTTGGATTAAAAGTTTAGGGCGAACTCTCAACGAAAGGGGTCAGTCTTACAATCATTTGGTCGCTATAGTTCATTACCTCACTAGGCGTCTAGACCGGCATATCTGCATTCTAGAGCAACAATGACACCGTGTATGTTGGCAGGTGTCAAGGCTAAGGATTGAGTCACCGAGCTTCGGGACTCCATAAGGGGGAATTTACGGCATATGACCTTCTTAGTGGAGACCGTTTTACCGAGCGGTACCTGTTGGACCTGTTAAGCGCTTATCAACAACGCCTCCTAAGTTTCAAGATTTGTTACTCACATACGATTAGCAACCCAGTTTTGCTCAGAGTCGTCAAAATAAAACATTACACTCCGCTGCATTAGAGCAATGTTAACAGGTGGTTTCGGAAGCGGAGGATCCTCTCCGGCCAGATCTTCATCGGCGAACCAAAACTGATAGCAGATAGGCGAGTCCACATAATAAGCTACATGCCAATGTGGAGGGGTGTGTAATGTTTTATTGGAAGTCTCTAAGCGGTTCGAGATCGCTAAGTGGTACCATGATCACCACGACCAAGATTAGTTTTCATAAGACTCGGACCATTCATTACGTGGACCATCCAAACCGTGCGACCATCGGACCCTGCATCACTCAAGTGAGACGTGTGCGTGTAACCTGCAGAATTTAGGCGATGGATTGGATTTGTATACTGGCACCCAGAAAGCGGTGATCGTAGTTTCGCCAACGCGCAGTCGGGTTTGAGATTAATAACCATCTAGTCGAGAGACTCTGTTAAATTATCTGTCCAAACACACAGACAGACAAGTTAAATGGGCGTCGCTTCTGGTGGTAACTATAAATCACTGTCCAGGCACTCCCAACATATTTTACTCAAGGTCTATACATCCACACGACCATTGCCCTGAATTAATGTTACGTTGCAAACGTTTTTGCCTCTGGATACCCCCGGGGTGAAGATCAGACTTGGGAAACGTGCTACGCAAAGCCGCCGACAATCCTACAGGCATCTTAGCGCCTGAGGCAGCATAGCGAATAGCCCCCGTGAAAAGTCCGCTTCAGAAACTACGAGGAGACTGGTAGTTCAGGGCTGCCTGGAGGACAGTTAATGACGAAAGCACCTATGTGACGCTACAAATCTCAACAAGAGGTCGCGGAGGATCCTGGTCCTCCCATGATTGAACTGACCCCGCGTTTTTAGTCATCAAAGTATTACGTTATTACCGTCTAGACGCCTATAAGTTGGTGTCTTGCAGACCTCCGCCCTAGAAGGCGGGCATCTTCCCCTACTTGTGTCACCCCGGCGGTATCGATCGGTGAGAGCACACTGGCACTCTCACAGATGACAGGCCTATACATGAAATTGAACGAAAGAAACATGTCTTGTTCATTTTTGCCAGTTTTACACTCTAGCCCAGGTGCCGGAACATACGAACCGGGCGACGGTGCAAGGGAGTATAGTGCTTGATCCGTCTTGCCAGCTCGGGCGTAAGTTATTCGACTGCAGTATCTACTCACATACATAGACGGTCCGCGTAAGAGATCTAGTTGGCAGGTTCGCGTCTTGCTTACTGCCAGTTGGAGTTAGGTAGAACCTCAAGAGGTAGCCTAACTGGGATGGGCCAAGGCGTGGTATTAGGACCTATGCATCATGTGACGAAACCTTCTGGATGGATATGAGTCGTATGCTATACCCCAGAGACCGGCAAGCCAACGATCCCTGTTCACGGGTTGAACCCGAAGTGAACCGCGAGGCAAAGTACGGGTGCAAGGCCGAGCTCTTCGATGTAGGGGTTGGGCCAATCAACGCGTTCCCCTGACGCGAGTTTGCAAATGTTGAAACGCCTACCATCACGAATTATTGGTGCCCCTTATGAGAATATGACCATTCCTGTCTGACAGATTGTCCTAAGCCCGGCCATCCTACGCGCGCGTCGATCAGAATCTCTTGGACTCAGGAACTCTGCCCAACCTGACATCGGAATAAAACACTATACCCCTCTACACCATATCGCATGATTCACGACTGCATCTAACAATCAAGGTAGTAGTAAGTCACACACGATATGCCCAAGCGTCCTCCTCTGACATAGCTTTTGCCTCCAACCGAATACTATTGGTCAATTTTCAATCATTCACACTTCCCGACCGCACTGATGCCACAAAAATGGACGCCCGGCGCATCCTTAGTCTCATCATACGAATATTCCACCGGATTTGCGACCTACAGAGTTAAAGGTCTGGGAAATAGGCTTCTCGAGCCGCGTTGGCCGAGGAAGGACTGACGGGAATTCCAGTTAGCTGACCCTGTGGCTTAAGCAAAGTGGTGCTTAACCGAGAAAACTACAGCCCGCGAACATCATATTCTGCTAGTTTACTTCATGTGGGATGCTGCGAAGGGTGGCCTTAGCGTCACTATTCAGCTAAACACGAGCGATGGCTACCTGAACTTTGGGACAGATACTTGCGGGACCTAGATAGCATTGTTTAAATGCGGGGCACGAGCGTTGTGTAGTCAAAGAAGAGTGGATATCCCCATCAGTGGTGGGCTCAGCGAGAACATTTCTTCAGCACATGGGCATGTTAATTCGCATTTAGCTCACTATCCCGATGGGGCAAACAATCGGTCATGGGTATATGTCATGATGAGGGATCCGGCTCATTAAGCATTACACACCGCTCCATAAAAGTAATCGTTACTTCTTCTTGTTTTCAGCCAAGATACGCTTCTAGTCAGCTATAATCAAAGGGCATTTGTCATCGCTTTCGCGCGCAACTCGAATCGCGTTGCGAGACAGAAGTTGTTTATAAAACCGCCTACTCTTCAACGGCCTTCCGGTGCCTGTGTCCCGACCTAACCACGATACTTAATAACTGCGCGTTGTATCATGTCTCGCCGGATGGCATCCCGCCTAGCCTAAAGGTTGGCAATAGTTCCTCCCGTGAGACATAGTTTTGACCTGGCGCTGAATGTGAAGTTCAAACGCGTTTAATAGGGCTCCATGGGAACGATACAGCCATTATGGTTGGTGATTTATCTAAAGGATGGCCCGACAGATTACGTTTTCCACCTGCGAGGCAATCTAATCTAACAAAGGATCTGCAGAAGTGGACAGCGAAGAGGGTACGTATAATCACTGCTGTCGTGTGACCTTGATGCGCTAACTTGCAGGAGGAGAGATCCGTGATCCGGGGGGTGCTTTATAAACGGTCATAGTTATGAGTTCTCCTTGTTGCCAATAATCTGTCATATCTCGCCCTTCCTTCCCAGAGGCACCCTATGACTAGTGTTTTACGTTACCGTATACACCGCGTTACCCGGAGATGCAGGTTCTGCCAGTCCTCAGATCCTCCTGCTTCCAGGCGCTACTCGACTTCTGGCTGGGTGTGGCGCGACGGCAGGCGACGAGAAGATAGGCATCAAACATTACACACCTCTACACCTCGAACAATCTGGACACTCTCACGTATAGTGCTTCTGGGGGAAAGTCAATGGTTATTAAATTTTGAGCGTCGGTGTTGTACGTTTCGTATGCTGCGTGAGAGCCATTGGAATCAGATTGGGCGGCAAGGACCAGAAGGTCATCAAGCACTATACCCCCTTACACAGCTAGACATCGAGCAAATCGTGGCAGCTGGCGCGTGATGTGACCACATACGTCGGAGGTTATTCGATATCCTACCAGGCCGATTCCTTGTGAACTAACTGACGACCTTGTATGCAGTGCTGAGTAAGTATCGTCTTCGTTTTGGGAGCTTCACTTGGGCTACCCGCGCGTCCTTAAGTTTTACTGGCACCATGATCAGTTGGCACAGCACATGGGTTGTGGTATGGGTCTTTTTATGCTGAGATGAAGTTGAAAACTACTGTTTTACGGTCACTGCAGCGTAGCCACTACATCTGTTTGGCTCCTACCTATAAAGGTTACTGTTGCGCTTCCGTCCACAACCTGGACCAAACTGTGTAGCTAAATACACGGCGTAGCCGCAACAAGAGCAATGTGTATCAACATGGTCCAAGCTGCCAGGCCATCGAGAGACGGAATCAGGGAGCTGTCCTAACCCGCGGATACAAGGATGCGAAGGAAGTCATATCCGAACCGCGCGACCGGCAGATAGTTTGAGGAATTATGAACTGATCTATGGCATTTAGTACTACCAGTCT";
my $prot = "IKHYTPLH";

my %aaToCodon;
my $probeCt = 1;

open(FH, "codonToAalist.txt") or die "Cant open file: $!\n";
while(<FH>){
	if($_ =~ m/(\w+)\s+(\w)/){
		push(@{$aaToCodon{$2}}, $1);
	}
	else{
		print "Error on line: $_";
	}
}

my @seqs;
my $flag = 0;
foreach my $aa(split(//, $prot)){
	
	$probeCt *= @{$aaToCodon{$aa}};
	if(!$flag){
		push(@seqs, @{$aaToCodon{$aa}});
		$flag = 1;
		next;
	}
	
	my @temp = @seqs;
	@seqs = ();
	foreach(@temp){
		foreach my $codon(@{$aaToCodon{$aa}}){
			push(@seqs, $_.$codon);
		}
	}
	
}

#print join("\n", @seqs);
#print $#seqs,"\n";
#print $probeCt;


foreach my $subseq(@seqs){
	
	$subseq =~s/U/T/g;
	#print "$_\n";
	
	my $rev = reverse($subseq);
	$rev =~ tr/[ATGC]/[TACG]/;
	
	if($dna=~m/($subseq|$rev)/){
		my @temp = ($dna =~m/(?=($subseq|$rev))/g);
		print join("\n", @temp),"\n";
	}
}
